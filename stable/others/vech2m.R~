##' <description>
##'
##' <details>
##' @title <short tile>
##' @param vech 
##' @param diag 
##' @return 
##' @references 
##' @author Feng Li, Department of Statistics, Stockholm University, Sweden.
##' @note
##'     Created: Wed Oct 12 20:23:17 CEST 2011;
##'     Current: Wed Oct 12 20:23:51 CEST 2011.
vech2m <- function(vech, diag = TRUE)
{
  c <- length(vech)
  p <- (1 - 2*diag +sqrt(8*c+1))/2 # n^2 -n  =  2c; or n^2 + n  =  2c
  out <- matrix(1, p, p)
  idx.lower <- as.vector(lower.tri(out, diag = diag))
  if(length(idx.lower) != c)
    {
      stop ("Input vector length not match with length of matrix triangular.")
    }
  out[idx.lower] <- vech
  idx.upper <- as.vector(upper.tri(out, diag = diag))
  out.t <- t(out)
  out[idx.upper] <- out.t[idx.upper]
  return(out)
}
